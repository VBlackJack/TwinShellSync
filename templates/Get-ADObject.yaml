id: 24834356-81ca-41cd-8718-06c8e958d1fb
name: Get-ADObject
platform: Windows
commandPattern: $searchPassword = '{recoveryPassword}'; Get-ADObject -Filter "objectClass -eq 'msFVE-RecoveryInformation'" -Properties msFVE-RecoveryPassword | Where-Object {$_.'msFVE-RecoveryPassword' -like "*$searchPassword*"} | ForEach-Object { $computerDN = ($_.DistinguishedName -split ',',2)[1]; $computer = Get-ADComputer -Identity $computerDN; [PSCustomObject]@{ Computer=$computer.Name; RecoveryPassword=$_.'msFVE-RecoveryPassword'; ComputerDN=$computer.DistinguishedName } }
parameters:
- name: recoveryPassword
  label: Mot de passe de récupération
  type: string
  defaultValue: ''
  required: true
  description: Mot de passe ou début du mot de passe (premiers chiffres)
