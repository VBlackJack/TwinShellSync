id: a3520c98-0812-499e-b7b9-0d16b0938f41
name: Disable-WindowsServices
platform: Windows
commandPattern: "$servicesToDisable = @('DiagTrack','dmwappushservice','SysMain','WSearch','TabletInputService','RetailDemo','TapiSrv','PhoneSvc','MapsBroker','SharedAccess','lfsvc','WbioSrvc','WMPNetworkSvc','wisvc','icssvc','WerSvc','StorSvc','DusmSvc','OneSyncSvc','PimIndexMaintenanceSvc','UnistoreSvc','UserDataSvc','WalletService','XblAuthManager','XblGameSave','XboxNetApiSvc','XboxGipSvc','Fax','PrintWorkflowUserSvc','RemoteRegistry','RemoteAccess','SCPolicySvc','wercplsupport','WpcMonSvc','SEMgrSvc','PcaSvc','WdiServiceHost','WdiSystemHost','diagnosticshub.standardcollector.service','DPS','WiaRpc','stisvc','SCardSvr','ScDeviceEnum','SensorDataService','SensrSvc','SensorService','CDPSvc','CDPUserSvc','PushToInstallService','spectrum','WpnService','WpnUserService','DevicePickerUserSvc','DevicesFlowUserSvc','BcastDVRUserService','BluetoothUserService','CaptureService','ConsentUxUserSvc','CredentialEnrollmentManagerUserSvc','DeviceAssociationBrokerSvc','MessagingService','PrintWorkflowUserSvc','NPSMSvc','UdkUserSvc','UnistoreSvc','UserDataSvc','WalletService','FrameServer','FontCache','DoSvc','BITS','wuauserv','TrustedInstaller','InstallService','AppXSvc','ClipSVC','LicenseManager','NgcSvc','NgcCtnrSvc','TokenBroker','KeyIso','VaultSvc','Wecsvc','EventLog','EventSystem','SDRSVC','SENS','SystemEventsBroker','Schedule','TimeBrokerSvc','SstpSvc','RasMan','RasAuto','SessionEnv','TermService','UmRdpService','RpcLocator','seclogon','W3SVC','IISADMIN','AppHostSvc','MSDTC','NetTcpPortSharing','COMSysApp','VSS','swprv','MSMQ','MSMQTriggers','iprip','simptcp','MSiSCSI','fhsvc','SSDPSRV','upnphost','fdPHost','FDResPub','lltdsvc','p2pimsvc','p2psvc','PNRPsvc','PNRPAutoReg','HomeGroupListener','HomeGroupProvider','Browser','LanmanWorkstation','LanmanServer','SessionEnv','TermService','UmRdpService','AppReadiness','AppMgmt','BDESVC','EFS','SamSs','VaultSvc','KtmRm','CryptSvc','WbioSrvc','AxInstSV','AppIDSvc','PeerDistSvc','Netlogon','DFSR','DFS','CscService','Netman','NcdAutoSetup','NcbService','QWAVE','Wcmsvc','dot3svc','WwanSvc','WinHttpAutoProxySvc','iphlpsvc','IpxlatCfgSvc','PolicyAgent','IKEEXT','fhsvc','TrkWks','CscService','Themes','MMCSS','wscsvc','WinDefend','WdNisSvc','mpssvc','BFE','hidserv','HvHost','vmickvpexchange','vmicguestinterface','vmicshutdown','vmicheartbeat','vmicvmsession','vmicrdv','vmictimesync','vmicvss','HvHost','svsvc','AudioSrv','AudioEndpointBuilder','Audiosrv','RtkAudioUniversalService','NahimicService','LightingService','asus','asusm','ROG'); $count = 0; foreach ($svc in $servicesToDisable) { try { $service = Get-Service -Name $svc -ErrorAction SilentlyContinue; if ($service -and $service.StartType -ne 'Disabled') { Stop-Service -Name $svc -Force -ErrorAction SilentlyContinue; Set-Service -Name $svc -StartupType Disabled -ErrorAction Stop; $count++ } } catch { Write-Warning \"Impossible de désactiver $svc\" } }; Write-Host \"$count services désactivés sur $($servicesToDisable.Count) ciblés\" -ForegroundColor Green; Write-Warning \"IMPORTANT: Redémarrage requis. Certaines fonctionnalités peuvent être affectées.\""
parameters: []
