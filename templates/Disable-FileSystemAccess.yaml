id: ddff350d-01a6-484a-a5b2-79d4a8010665
name: Disable-FileSystemAccess
platform: Windows
commandPattern: param([string]$Scope = 'CurrentUser'); $path = if ($Scope -eq 'AllUsers') { 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary' } else { 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary' }; New-Item -Path $path -Force | Out-Null; Set-ItemProperty -Path $path -Name 'Value' -Type String -Value 'Deny'; $path2 = if ($Scope -eq 'AllUsers') { 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess' } else { 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess' }; New-Item -Path $path2 -Force | Out-Null; Set-ItemProperty -Path $path2 -Name 'Value' -Type String -Value 'Deny'
parameters:
- name: Scope
  label: Port√©e
  type: string
  defaultValue: CurrentUser
  required: false
  description: CurrentUser ou AllUsers
