id: 1807e498-3900-4f8b-8713-46292b7c4a45
name: Register-ScheduledTask
platform: Windows
commandPattern: $action = New-ScheduledTaskAction -Execute '{executable}' -Argument '{arguments}'; $trigger = New-ScheduledTaskTrigger {triggertype}; Register-ScheduledTask -TaskName '{taskname}' -Action $action -Trigger $trigger {user}
parameters:
- name: taskname
  label: Nom de la tâche
  type: string
  defaultValue: MyTask
  required: true
  description: Nom de la tâche à créer
- name: executable
  label: Exécutable
  type: string
  defaultValue: powershell.exe
  required: true
  description: Programme à exécuter
- name: arguments
  label: Arguments
  type: string
  defaultValue: -File C:\Scripts\backup.ps1
  required: false
  description: Arguments de la commande
- name: triggertype
  label: Déclencheur
  type: string
  defaultValue: -Daily -At 9:00AM
  required: true
  description: Type de déclencheur (-Daily, -Weekly, -AtStartup, -AtLogon)
- name: user
  label: Utilisateur
  type: string
  defaultValue: -User 'SYSTEM'
  required: false
  description: "Compte d'exécution (ex: -User 'SYSTEM')"
