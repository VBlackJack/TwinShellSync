id: 99f68619-e01a-4a11-89b7-5914d031daa1
name: Get-BitLockerVolume
platform: Windows
commandPattern: "$report = @(); Get-BitLockerVolume | ForEach-Object { $vol = $_; $_.KeyProtector | Where-Object {$_.KeyProtectorType -eq 'RecoveryPassword'} | ForEach-Object { $report += [PSCustomObject]@{ Volume=$vol.MountPoint; RecoveryPassword=$_.RecoveryPassword; KeyId=$_.KeyProtectorId } } }; $report | Export-Csv C:\\BitLocker-Recovery-Report.csv -NoTypeInformation; Write-Host 'Rapport sauvegard√©: C:\\BitLocker-Recovery-Report.csv' -ForegroundColor Green"
parameters: []
