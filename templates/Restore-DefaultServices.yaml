id: 172a53d3-1e7b-4999-9fdd-5defeb502dd0
name: Restore-DefaultServices
platform: Windows
commandPattern: Write-Host "Restauration des services Windows par défaut..." -ForegroundColor Yellow; $defaultServices = @{'DiagTrack'='Automatic';'dmwappushservice'='Manual';'SysMain'='Automatic';'WSearch'='Manual';'WerSvc'='Manual';'BITS'='Manual';'wuauserv'='Manual';'DoSvc'='Automatic';'Schedule'='Automatic';'EventLog'='Automatic';'AudioSrv'='Automatic';'AudioEndpointBuilder'='Automatic';'Themes'='Automatic';'MMCSS'='Automatic';'wscsvc'='Automatic';'WinDefend'='Automatic'}; $count = 0; foreach ($svc in $defaultServices.GetEnumerator()) { try { $service = Get-Service -Name $svc.Key -ErrorAction SilentlyContinue; if ($service) { $startType = switch($svc.Value) { 'Automatic' { 'Automatic' } 'Manual' { 'Manual' } 'Disabled' { 'Disabled' } default { 'Manual' } }; Set-Service -Name $svc.Key -StartupType $startType -ErrorAction Stop; $count++ } } catch { Write-Warning "Impossible de restaurer $($svc.Key)" } }; Write-Host "$count services restaurés" -ForegroundColor Green; Write-Host "Redémarrage recommandé" -ForegroundColor Yellow
parameters: []
