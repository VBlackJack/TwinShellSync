{
  "id": "7a226e70-c903-43db-b0b4-1da384d1c429",
  "name": "Get-ChildItem",
  "platform": "Windows",
  "commandPattern": "$daysThreshold = {daysThreshold}; Get-ChildItem -Path Cert:\\LocalMachine\\My | Where-Object {$_.NotAfter -lt (Get-Date).AddDays($daysThreshold)} | Select-Object Subject, Issuer, NotAfter, @{Name=\u0027DaysRemaining\u0027;Expression={($_.NotAfter - (Get-Date)).Days}}, Thumbprint | Sort-Object NotAfter | Format-Table -AutoSize",
  "parameters": [
    {
      "name": "daysThreshold",
      "label": "Seuil en jours",
      "type": "string",
      "defaultValue": "30",
      "required": true,
      "description": "Nombre de jours avant expiration pour alerter"
    }
  ]
}