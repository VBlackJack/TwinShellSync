id: c0a6d7a4-b698-4b23-929c-8fa3ce7e0640
name: Get-WinEvent
platform: Windows
commandPattern: Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4624,4625; StartTime=(Get-Date).AddDays(-{days})} | Where-Object {$_.Message -like '*LogonType*10*' -or $_.Message -like '*LogonType*3*'} | Select-Object TimeCreated,Id,@{Name='EventType';Expression={if($_.Id -eq 4624){'Success'}else{'Failed'}}},Message | Format-Table -AutoSize
parameters:
- name: days
  label: Nombre de jours
  type: number
  defaultValue: 7
  required: true
  description: Nombre de jours à analyser en arrière
