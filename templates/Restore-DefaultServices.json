{
  "id": "172a53d3-1e7b-4999-9fdd-5defeb502dd0",
  "name": "Restore-DefaultServices",
  "platform": "Windows",
  "commandPattern": "Write-Host \u0022Restauration des services Windows par d\u00E9faut...\u0022 -ForegroundColor Yellow; $defaultServices = @{\u0027DiagTrack\u0027=\u0027Automatic\u0027;\u0027dmwappushservice\u0027=\u0027Manual\u0027;\u0027SysMain\u0027=\u0027Automatic\u0027;\u0027WSearch\u0027=\u0027Manual\u0027;\u0027WerSvc\u0027=\u0027Manual\u0027;\u0027BITS\u0027=\u0027Manual\u0027;\u0027wuauserv\u0027=\u0027Manual\u0027;\u0027DoSvc\u0027=\u0027Automatic\u0027;\u0027Schedule\u0027=\u0027Automatic\u0027;\u0027EventLog\u0027=\u0027Automatic\u0027;\u0027AudioSrv\u0027=\u0027Automatic\u0027;\u0027AudioEndpointBuilder\u0027=\u0027Automatic\u0027;\u0027Themes\u0027=\u0027Automatic\u0027;\u0027MMCSS\u0027=\u0027Automatic\u0027;\u0027wscsvc\u0027=\u0027Automatic\u0027;\u0027WinDefend\u0027=\u0027Automatic\u0027}; $count = 0; foreach ($svc in $defaultServices.GetEnumerator()) { try { $service = Get-Service -Name $svc.Key -ErrorAction SilentlyContinue; if ($service) { $startType = switch($svc.Value) { \u0027Automatic\u0027 { \u0027Automatic\u0027 } \u0027Manual\u0027 { \u0027Manual\u0027 } \u0027Disabled\u0027 { \u0027Disabled\u0027 } default { \u0027Manual\u0027 } }; Set-Service -Name $svc.Key -StartupType $startType -ErrorAction Stop; $count\u002B\u002B } } catch { Write-Warning \u0022Impossible de restaurer $($svc.Key)\u0022 } }; Write-Host \u0022$count services restaur\u00E9s\u0022 -ForegroundColor Green; Write-Host \u0022Red\u00E9marrage recommand\u00E9\u0022 -ForegroundColor Yellow",
  "parameters": []
}